# Reflected XSS в POST-параметре name маршрута localhost/hello

## Описание:
    В веб-приложении была обнаружена уязвимость Reflected XSS (Cross-Site Scripting) в маршруте /hello. 
    Параметр name, передаваемый через POST-запрос, используется в HTML-ответе без фильтрации или экранирования, 
    что позволяет злоумышленнику вставлять и выполнять произвольный JavaScript-код в браузере жертвы.

## Влияние:
- Кража данных: Злоумышленник может использовать XSS для кражи cookies, токенов сессии или других конфиденциальных данных.
- Фишинг: Возможна подмена содержимого страницы, что увеличивает риск успешной атаки социальной инженерии.
- Использование в цепочке атак: Уязвимость может быть использована для установки вредоносного ПО или перенаправления на вредоносные сайты.

## Шаги для воспроизведения:
- Отправьте POST-запрос на маршрут /hello с вредоносным JavaScript-кодом в параметре name:
- curl -X POST -d "name=<script>alert('АТАКА XSS')</script>" http://localhost/hello
- Сервер возвращает следующий HTML-ответ
- <html><body> <h3>Hello, <script>alert('АТАКА XSS')</script>!</h3> </body></html>
- Открыть ответ в браузере. Код JavaScript (<script>alert('XSS')</script>) будет выполнен, что подтверждает наличие XSS.

## Доказательство концепции (PoC):
### Запрос:
    curl -X POST -d "name=<script>alert('XSS')</script>" http://localhost/hello
### Результат:
    В браузере пользователя появляется всплывающее окно с сообщением XSS.

## Технические детали:
    Уязвимый маршрут: /hello
    Метод: POST
    Параметр: name
    Тип уязвимости: Reflected XSS
    Причина: Отсутствует фильтрация или экранирование пользовательского ввода.

## Рекомендации по исправлению:

### Экранирование пользовательского ввода:
    Используйте встроенные функции для экранирования HTML, чтобы предотвратить выполнение вредоносного кода. Например:

    from markupsafe import escape
    name = escape(request.form.get('name'))

### Использование Content Security Policy (CSP):

    Добавить заголовок Content-Security-Policy для ограничения выполнения неподписанного JavaScript.

    response.headers['Content-Security-Policy'] = "script-src 'self';"

### Валидация входных данных:
    Отклоняйте потенциально опасные символы (например, <, >, ', " и т. д.) в пользовательском вводе.

## Окружение:
    Google Chrome версия 131.0.6778.140

## Уровень риска:
    CVSS: 6.1 (Medium)
    Метрика: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N

## Рекомендации по защите:
    Убедитесь, что все пользовательские данные, отображаемые на страницах, проходят фильтрацию и экранирование.
    Настройте Content Security Policy (CSP) для ограничения выполнения неподписанного JavaScript.
    Используйте актуальные библиотеки и фреймворки с встроенной защитой от XSS.